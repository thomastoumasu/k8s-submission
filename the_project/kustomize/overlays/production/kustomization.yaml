apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ../../base
  - ./broadcaster-deployment.yaml
  - ./dumper.yaml

patches:
  - patch: |
      - op: replace
        path: /spec/hostnames
        value:
          - www.thomastoumasu.dpdns.org
    target:
      kind: HTTPRoute
      name: frontend-route
  - patch: |
      - op: replace
        path: /spec/hostnames
        value:
          - www.thomastoumasu.dpdns.org
    target:
      kind: HTTPRoute
      name: backend-route
namespace: production
images:
  - name: PROJECT/BACKEND_IMAGE
    newName: europe-north1-docker.pkg.dev/dwk-gke-480809/my-repository/backend
    newTag: production-eeb79ae7fbf3614d481aa9589e88711550955ba2
  - name: PROJECT/BROADCASTER_IMAGE
    newName: europe-north1-docker.pkg.dev/dwk-gke-480809/my-repository/broadcaster
    newTag: production-eeb79ae7fbf3614d481aa9589e88711550955ba2
  - name: PROJECT/DB_IMAGE
    newName: europe-north1-docker.pkg.dev/dwk-gke-480809/my-repository/mongo
    newTag: production-eeb79ae7fbf3614d481aa9589e88711550955ba2
  - name: PROJECT/FRONTEND_IMAGE
    newName: europe-north1-docker.pkg.dev/dwk-gke-480809/my-repository/frontend
    newTag: production-eeb79ae7fbf3614d481aa9589e88711550955ba2
  - name: PROJECT/IMAGEFINDER_IMAGE
    newName: europe-north1-docker.pkg.dev/dwk-gke-480809/my-repository/image-finder
    newTag: production-eeb79ae7fbf3614d481aa9589e88711550955ba2
